#!/usr/bin/env python3
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ –ø—ä—Ä–≤–æ–±–∏—Ç–Ω–∏—Ç–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏
===============================================

–¢–æ–∑–∏ —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑–≤–∞ –∫–∞–∫ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –Ω–æ–≤–∏—Ç–µ –º–æ–¥—É–ª–∏ –∑–∞:
1. –ê–Ω–∞–ª–∏–∑ –Ω–∞ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ç–∞
2. –ê–Ω–∞–ª–∏–∑ –Ω–∞ –æ—Å—Ç–∞—Ç—ä—á–Ω–∏—è —à—É–º
3. –ö–æ–º–ø–ª–µ–∫—Å–µ–Ω –∞–Ω–∞–ª–∏–∑ –Ω–∞ –ø—ä—Ä–≤–æ–±–∏—Ç–Ω–∏—Ç–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏

–í–∫–ª—é—á–≤–∞ —Ä–∞–∑–º–∏—à–ª–µ–Ω–∏—è—Ç–∞ –∑–∞ –æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –Ω–∞ –∞—Ç–æ–º–∏ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è
–∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç—Ç–∞ –∑–∞ –µ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –Ω–∞ —Ä–∞–Ω–Ω–∏ –≥–∞–ª–∞–∫—Ç–∏–∫–∏.
"""

import numpy as np
import matplotlib.pyplot as plt
import logging

from primordial_analysis import (
    RecombinationAnalyzer,
    RelicNoiseAnalyzer,
    PrimordialFluctuationAnalyzer
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –ª–æ–≥–∏—Ä–∞–Ω–µ—Ç–æ
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

def demo_recombination_analysis():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ç–∞."""
    print("üî¨ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ù–ê –ê–ù–ê–õ–ò–ó–ê –ù–ê –†–ï–ö–û–ú–ë–ò–ù–ê–¶–ò–Ø–¢–ê")
    print("=" * 60)
    
    # –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
    analyzer = RecombinationAnalyzer(z_recomb=1100)
    
    # –í—Ä–µ–º–µ–≤–∞ –æ—Å
    tau = np.linspace(1.0, 4.0, 1000)
    
    # –ï–Ω–µ—Ä–≥–∏–π–Ω–∞ –ø–ª—ä—Ç–Ω–æ—Å—Ç
    rho = analyzer.energy_density_evolution(tau)
    
    print(f"œÑ –ø—Ä–∏ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è: {analyzer.tau_recomb:.3f}")
    print(f"–ö—Ä–∏—Ç–∏—á–Ω–∞ –µ–Ω–µ—Ä–≥–∏–π–Ω–∞ –ø–ª—ä—Ç–Ω–æ—Å—Ç: {analyzer.rho_recomb_critical:.2e} J/m¬≥")
    
    # –ê–Ω–∞–ª–∏–∑ –Ω–∞ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏–æ–Ω–Ω–∏—è –ø—Ä–æ–∑–æ—Ä–µ—Ü
    analysis = analyzer.plot_recombination_analysis(tau, rho)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –¥–æ–∫–ª–∞–¥
    report = analyzer.generate_comprehensive_report(tau, rho)
    print("\nüìÑ –î–û–ö–õ–ê–î –ó–ê –†–ï–ö–û–ú–ë–ò–ù–ê–¶–ò–Ø–¢–ê:")
    print(report)
    
    return analysis

def demo_relic_noise_analysis():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ –æ—Å—Ç–∞—Ç—ä—á–Ω–∏—è —à—É–º."""
    print("\nüîä –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ù–ê –ê–ù–ê–õ–ò–ó–ê –ù–ê –û–°–¢–ê–¢–™–ß–ù–ò–Ø –®–£–ú")
    print("=" * 60)
    
    # –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
    analyzer = RelicNoiseAnalyzer(cmb_amplitude=1e-5)
    
    # –í—Ä–µ–º–µ–≤–∞ –æ—Å
    tau = np.linspace(1.0, 6.0, 1000)
    
    # –û—Å–Ω–æ–≤–Ω–∞ –ø–ª—ä—Ç–Ω–æ—Å—Ç
    rho_base = 1 / (tau**2)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –æ—Å—Ç–∞—Ç—ä—á–µ–Ω —à—É–º
    delta_rho = analyzer.generate_primordial_noise(tau, spectral_index=0.96)
    
    print(f"CMB –∞–º–ø–ª–∏—Ç—É–¥–∞: {analyzer.cmb_amplitude:.2e}")
    print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞ —à—É–º–∞: {np.std(delta_rho):.2e}")
    
    # –ö–æ–º–ø–ª–µ–∫—Å–µ–Ω –∞–Ω–∞–ª–∏–∑
    spectral_analysis, stats = analyzer.plot_comprehensive_analysis(tau, rho_base, delta_rho)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –¥–æ–∫–ª–∞–¥
    report = analyzer.generate_relic_noise_report(tau, rho_base, delta_rho)
    print("\nüìÑ –î–û–ö–õ–ê–î –ó–ê –û–°–¢–ê–¢–™–ß–ù–ò–Ø –®–£–ú:")
    print(report)
    
    return spectral_analysis, stats

def demo_primordial_fluctuations():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –ø—ä–ª–Ω–∏—è –∞–Ω–∞–ª–∏–∑ –Ω–∞ –ø—ä—Ä–≤–æ–±–∏—Ç–Ω–∏—Ç–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏."""
    print("\nüåå –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ù–ê –ê–ù–ê–õ–ò–ó–ê –ù–ê –ü–™–†–í–û–ë–ò–¢–ù–ò–¢–ï –§–õ–£–ö–¢–£–ê–¶–ò–ò")
    print("=" * 60)
    
    # –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
    analyzer = PrimordialFluctuationAnalyzer(z_recomb=1100, cmb_amplitude=1e-5)
    
    # –ü—ä–ª–µ–Ω –∞–Ω–∞–ª–∏–∑
    results = analyzer.run_complete_analysis(tau_range=(0.5, 5.0), n_points=1000)
    
    print("\nüìä –†–ï–ó–£–õ–¢–ê–¢–ò –û–¢ –ê–ù–ê–õ–ò–ó–ê:")
    print("-" * 40)
    
    structure_analysis = results['structure_analysis']
    comparison = results['comparison']
    
    print(f"–§—Ä–∞–∫—Ü–∏—è –∫–æ–ª–∞–ø—Å–∏—Ä–∞—â–∏ —Ä–µ–≥–∏–æ–Ω–∏: {structure_analysis['collapse_fraction']:.2%}")
    print(f"–ë—Ä–æ–π –∫–æ–ª–∞–ø—Å–∏—Ä–∞—â–∏ –≥—Ä—É–ø–∏: {len(structure_analysis['collapse_groups'])}")
    print(f"–ö–æ—Ä–µ–ª–∞—Ü–∏—è —Å ŒõCDM: {comparison['correlation_rho']:.3f}")
    print(f"–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞ –∑–Ω–∞—á–∏–º–æ—Å—Ç: {comparison['correlation_p_value']:.3f}")
    
    # –§–∏–Ω–∞–ª–µ–Ω –¥–æ–∫–ª–∞–¥
    print("\nüìÑ –§–ò–ù–ê–õ–ï–ù –î–û–ö–õ–ê–î:")
    print(results['final_report'])
    
    return results

def demo_theoretical_implications():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∏—Ç–µ –∏–º–ø–ª–∏–∫–∞—Ü–∏–∏."""
    print("\nüß† –¢–ï–û–†–ï–¢–ò–ß–ù–ò –ò–ú–ü–õ–ò–ö–ê–¶–ò–ò")
    print("=" * 60)
    
    print("""
    üìù –ö–õ–Æ–ß–û–í–ò –†–ê–ó–ú–ò–®–õ–ï–ù–ò–Ø:
    
    1. –£–î–™–õ–ñ–ï–ù–ê –†–ï–ö–û–ú–ë–ò–ù–ê–¶–ò–Ø:
       - –í —Ç–µ–æ—Ä–∏—è—Ç–∞ –∑–∞ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ –≤—Ä–µ–º–µ, —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ç–∞ –ø—Ä–æ—Ç–∏—á–∞ –ø–æ-–¥—ä–ª–≥–æ
       - –¢–æ–≤–∞ –ø–æ–∑–≤–æ–ª—è–≤–∞ –ø–æ-—Å—Ç–∞–±–∏–ª–Ω–æ –æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –Ω–∞ –≤–æ–¥–æ—Ä–æ–¥–Ω–∏ –∏ —Ö–µ–ª–∏–µ–≤–∏ –∞—Ç–æ–º–∏
       - –£–¥—ä–ª–∂–µ–Ω–∏—è—Ç –ø–µ—Ä–∏–æ–¥ —Å—ä–∑–¥–∞–≤–∞ —É—Å–ª–æ–≤–∏—è –∑–∞ —Ä–∞–Ω–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–æ–±—Ä–∞–∑—É–≤–∞–Ω–µ
    
    2. –õ–û–ö–ê–õ–ù–ò –§–õ–£–ö–¢–£–ê–¶–ò–ò:
       - –ù–µ–µ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Ç–æ —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–∞—á–∞–ª–Ω–∏—Ç–µ –µ–Ω–µ—Ä–≥–∏–∏
       - –í–æ–¥–∏ –¥–æ –ª–æ–∫–∞–ª–Ω–∏ —Ä–µ–≥–∏–æ–Ω–∏ —Å —Ä–∞–∑–ª–∏—á–Ω–æ —Ç–µ–º–ø–æ –Ω–∞ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è
       - –ü—ä—Ä–≤–∏—Ç–µ "–ø—Ä–æ–∑—Ä–∞—á–Ω–∏" –∑–æ–Ω–∏ –º–æ–≥–∞—Ç –¥–∞ —Å—Ç–∞–Ω–∞—Ç —Ü–µ–Ω—Ç—Ä–æ–≤–µ –Ω–∞ –≥–∞–ª–∞–∫—Ç–∏–∫–∏
    
    3. –ï–î–ù–û–í–†–ï–ú–ï–ù–ù–û –û–ë–†–ê–ó–£–í–ê–ù–ï:
       - –í—ä–∑–º–æ–∂–Ω–æ—Å—Ç –∑–∞ –µ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –Ω–∞ –∞—Ç–æ–º–∏ –∏ —Ä–∞–Ω–Ω–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
       - –ù–∞—Ä—É—à–∞–≤–∞ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ—Å—Ç
       - –û–±—è—Å–Ω—è–≤–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ç–∞ –Ω–∞ —Ä–∞–Ω–Ω–∏ –≥–∞–ª–∞–∫—Ç–∏–∫–∏ –ø—Ä–∏ –≤–∏—Å–æ–∫–∏ redshift
    
    4. –û–°–¢–ê–¢–™–ß–ï–ù –®–£–ú:
       - –ö–≤–∞–Ω—Ç–æ–≤–∏—Ç–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏ —Å–µ –∑–∞–ø–∞–∑–≤–∞—Ç –≤ CMB
       - –°–ø–µ–∫—Ç—Ä–∞–ª–Ω–∏—è—Ç –∏–Ω–¥–µ–∫—Å –µ —Å—ä–≤–º–µ—Å—Ç–∏–º —Å –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ç–∞
       - –í—ä–∑–º–æ–∂–Ω–æ—Å—Ç –∑–∞ –¥–µ—Ç–µ–∫—Ü–∏—è –Ω–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –æ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Ç–æ –≤—Ä–µ–º–µ
    
    5. –ö–û–°–ú–û–õ–û–ì–ò–ß–ù–ò –ü–û–°–õ–ï–î–ò–¶–ò:
       - –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —Ä–∞—Å—Ç–µ–∂ –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ç–µ
       - –†–∞–∑–ª–∏—á–Ω–∏ –∫–æ—Ä–µ–ª–∞—Ü–∏–æ–Ω–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ CMB
       - –ù–æ–≤–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏ –∑–∞ —Ä–∞–Ω–Ω–∞—Ç–∞ –í—Å–µ–ª–µ–Ω–∞
    """)

def main():
    """–û—Å–Ω–æ–≤–Ω–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è."""
    print("üöÄ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ù–ê –ü–™–†–í–û–ë–ò–¢–ù–ò–Ø –ê–ù–ê–õ–ò–ó")
    print("=" * 80)
    print("–ê–Ω–∞–ª–∏–∑ –Ω–∞ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ç–∞, –æ—Å—Ç–∞—Ç—ä—á–Ω–∏—è —à—É–º –∏ –ø—ä—Ä–≤–æ–±–∏—Ç–Ω–∏—Ç–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏")
    print("–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Ç–µ–æ—Ä–∏—è—Ç–∞ –∑–∞ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ –≤—Ä–µ–º–µ")
    print("=" * 80)
    
    try:
        # 1. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ç–∞
        recomb_analysis = demo_recombination_analysis()
        
        # 2. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –æ—Å—Ç–∞—Ç—ä—á–Ω–∏—è —à—É–º
        noise_analysis = demo_relic_noise_analysis()
        
        # 3. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –ø—ä—Ä–≤–æ–±–∏—Ç–Ω–∏—Ç–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏
        fluct_results = demo_primordial_fluctuations()
        
        # 4. –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏ –∏–º–ø–ª–∏–∫–∞—Ü–∏–∏
        demo_theoretical_implications()
        
        print("\n‚úÖ –í–°–ò–ß–ö–ò –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–ò –ó–ê–í–™–†–®–ï–ù–ò –£–°–ü–ï–®–ù–û!")
        
    except Exception as e:
        logger.error(f"–ì—Ä–µ—à–∫–∞ –≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è—Ç–∞: {e}")
        print(f"‚ùå –ì—Ä–µ—à–∫–∞: {e}")
        raise

if __name__ == "__main__":
    main() 